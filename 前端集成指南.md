# ğŸ”— Sora UI å‰ç«¯é›†æˆæŒ‡å—

**æ›´æ–°æ—¶é—´**: 2025-11-13  
**çŠ¶æ€**: âœ… é›†æˆå®Œæˆ

---

## ğŸ“¦ å·²åˆ›å»ºçš„æ–‡ä»¶

### åç«¯ API å®¢æˆ·ç«¯

**æ–‡ä»¶**: `sora-ui/src/api/backend-api.ts`

**åŠŸèƒ½**ï¼š
- âœ… å®Œæ•´çš„åç«¯ API è°ƒç”¨å°è£…
- âœ… WebSocket ç®¡ç†å™¨ç±»
- âœ… è®¤è¯ï¼ˆç™»å½•/æ³¨å†Œï¼‰
- âœ… ä»»åŠ¡ç®¡ç†ï¼ˆåˆ›å»º/æŸ¥è¯¢/åˆ—è¡¨/å–æ¶ˆï¼‰
- âœ… è§†é¢‘URLè·å–å’Œåˆ·æ–°
- âœ… å®æ—¶è¿›åº¦è®¢é˜…
- âœ… é›†æˆçš„è§†é¢‘ç”Ÿæˆæµç¨‹

### ç¯å¢ƒå˜é‡é…ç½®

**æ–‡ä»¶**: `sora-ui/.env.local`

```env
# åç«¯ API åœ°å€
VITE_BACKEND_URL=http://localhost:3001

# WebSocket åœ°å€
VITE_WS_URL=ws://localhost:3001/ws

# æ˜¯å¦å¯ç”¨åç«¯é›†æˆ
VITE_USE_BACKEND=true
```

---

## ğŸš€ å¿«é€Ÿé›†æˆæ­¥éª¤

### 1ï¸âƒ£ å¯åŠ¨åç«¯æœåŠ¡

```powershell
cd D:\tecx\text\25\soraui_4.0\sora-ui-backend

# å¯åŠ¨æ•°æ®åº“
docker-compose up -d postgres

# å¯åŠ¨åç«¯
npm run dev
```

**éªŒè¯**ï¼š
```powershell
Invoke-RestMethod -Uri "http://localhost:3001/health"
```

---

### 2ï¸âƒ£ å‰ç«¯ä½¿ç”¨åç«¯ API

#### æ–¹å¼ Aï¼šä½¿ç”¨é›†æˆæµç¨‹ï¼ˆæ¨èï¼‰

```typescript
import { generateVideoWithBackend, BackendWebSocket } from '@/api/backend-api';

// 1. åˆå§‹åŒ– WebSocket
const ws = new BackendWebSocket();
ws.connect(jwtToken);

// 2. ç”Ÿæˆè§†é¢‘ï¼ˆè‡ªåŠ¨ä½¿ç”¨ WebSocket å®æ—¶æ¨é€ï¼‰
const response = await generateVideoWithBackend(
  {
    prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«',
    model: 'sora_video2',
    duration: '10',
    aspectRatio: '16:9',
    image: baseImage64,  // å¯é€‰
  },
  jwtToken,
  (progress, status, message) => {
    // å®æ—¶è¿›åº¦å›è°ƒ
    console.log(`è¿›åº¦: ${progress}% | çŠ¶æ€: ${status} | ${message}`);
    updateUI(progress, status);
  },
  ws
);

// 3. æ’­æ”¾è§†é¢‘
if (response.status === 'success') {
  playVideo(response.video_url);
}
```

#### æ–¹å¼ Bï¼šæ‰‹åŠ¨ç®¡ç†

```typescript
import backendAPI from '@/api/backend-api';

// 1. ç™»å½•è·å– Token
const { token } = await backendAPI.login('username', 'password');

// 2. åˆ›å»ºä»»åŠ¡
const task = await backendAPI.createVideoTask({
  prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«',
  model: 'sora_video2',
  duration: '10',
}, token);

console.log('ä»»åŠ¡ID:', task.videoId);

// 3. è®¢é˜… WebSocket è¿›åº¦
const ws = new backendAPI.BackendWebSocket();
ws.connect(token);

ws.on('taskProgress', (payload) => {
  console.log('è¿›åº¦:', payload.progress + '%');
  console.log('åç«¯ID:', payload.videoId);
  console.log('å¤–éƒ¨ID:', payload.externalVideoId);
});

ws.on('taskCompleted', async (payload) => {
  console.log('ä»»åŠ¡å®Œæˆ!');
  const videoUrl = payload.result.videoUrl;
  playVideo(videoUrl);
});

ws.subscribeTask(task.videoId);

// 4. æˆ–è€…ä½¿ç”¨è½®è¯¢æ–¹å¼ï¼ˆé™çº§æ–¹æ¡ˆï¼‰
const pollTask = setInterval(async () => {
  const status = await backendAPI.getVideoTask(task.videoId, token);
  
  if (status.status === 'COMPLETED') {
    clearInterval(pollTask);
    const { url } = await backendAPI.getVideoUrl(task.videoId, token);
    playVideo(url);
  }
}, 5000);
```

---

### 3ï¸âƒ£ ä¿®æ”¹ç°æœ‰å‰ç«¯ä»£ç 

#### ä¿®æ”¹ API é…ç½®

**æ–‡ä»¶**: `sora-ui/src/config/api.ts`ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

```typescript
// æ·»åŠ åç«¯é…ç½®é€‰é¡¹
export const API_MODES = {
  DIRECT: 'direct',      // ç›´æ¥è°ƒç”¨å¤–éƒ¨APIï¼ˆåŸæœ‰æ–¹å¼ï¼‰
  BACKEND: 'backend',    // é€šè¿‡åç«¯è°ƒç”¨ï¼ˆæ–°æ–¹å¼ï¼‰
};

// ä»ç¯å¢ƒå˜é‡è¯»å–
export const USE_BACKEND = import.meta.env.VITE_USE_BACKEND === 'true';
```

#### ä¿®æ”¹è§†é¢‘ç”Ÿæˆé€»è¾‘

**ç¤ºä¾‹ä¿®æ”¹**ï¼ˆå‡è®¾åœ¨æŸä¸ªç»„ä»¶ä¸­ï¼‰ï¼š

```typescript
// ä¹‹å‰ï¼šç›´æ¥è°ƒç”¨å¤–éƒ¨API
import { generateVideoAsync } from '@/api/sora-async';

// ç°åœ¨ï¼šæ ¹æ®é…ç½®é€‰æ‹©
import { generateVideoAsync } from '@/api/sora-async';
import { generateVideoWithBackend, BackendWebSocket } from '@/api/backend-api';
import { USE_BACKEND } from '@/config/api';

// åœ¨ç»„ä»¶ä¸­
const generateVideo = async (request: SoraRequest) => {
  if (USE_BACKEND) {
    // ä½¿ç”¨åç«¯é›†æˆæ–¹å¼
    return await generateVideoWithBackend(
      request,
      userToken,
      onProgressUpdate,
      wsInstance
    );
  } else {
    // ä½¿ç”¨åŸæœ‰çš„ç›´æ¥è°ƒç”¨æ–¹å¼
    return await generateVideoAsync(
      request,
      apiConfig,
      onProgressUpdate
    );
  }
};
```

---

## ğŸ”Œ WebSocket é›†æˆç¤ºä¾‹

### React Hook

```typescript
// hooks/useBackendWebSocket.ts
import { useEffect, useRef, useState } from 'react';
import { BackendWebSocket } from '@/api/backend-api';

export const useBackendWebSocket = (token: string) => {
  const wsRef = useRef<BackendWebSocket>();
  const [connected, setConnected] = useState(false);

  useEffect(() => {
    if (!token) return;

    // åˆ›å»º WebSocket å®ä¾‹
    const ws = new BackendWebSocket();
    wsRef.current = ws;

    // ç›‘å¬è®¤è¯æˆåŠŸ
    ws.on('authSuccess', () => {
      setConnected(true);
      console.log('WebSocket å·²è¿æ¥å¹¶è®¤è¯');
    });

    // è¿æ¥
    ws.connect(token);

    // æ¸…ç†
    return () => {
      ws.disconnect();
    };
  }, [token]);

  return {
    ws: wsRef.current,
    connected,
  };
};

// ä½¿ç”¨
function VideoGenerator() {
  const { ws, connected } = useBackendWebSocket(userToken);

  const handleGenerate = async () => {
    if (connected && ws) {
      const response = await generateVideoWithBackend(
        request,
        userToken,
        (progress) => setProgress(progress),
        ws
      );
      
      if (response.status === 'success') {
        setVideoUrl(response.video_url);
      }
    }
  };

  return (
    <div>
      <div>WebSocket: {connected ? 'âœ… å·²è¿æ¥' : 'âŒ æœªè¿æ¥'}</div>
      <button onClick={handleGenerate}>ç”Ÿæˆè§†é¢‘</button>
      <Progress percent={progress} />
    </div>
  );
}
```

---

## ğŸ¯ é›†æˆåçš„ä¼˜åŠ¿

### âœ… å¯¹æ¯”åŸæœ‰æ–¹å¼

| ç‰¹æ€§ | åŸæœ‰æ–¹å¼ï¼ˆç›´æ¥è°ƒç”¨ï¼‰ | é›†æˆåç«¯ |
|------|------------------|----------|
| **å®æ—¶æ€§** | âŒ éœ€è¦è½®è¯¢ï¼ˆ30ç§’ï¼‰ | âœ… WebSocket æ¨é€ï¼ˆ<100msï¼‰ |
| **ç”¨æˆ·ç®¡ç†** | âŒ æ—  | âœ… JWT è®¤è¯ç³»ç»Ÿ |
| **ä»»åŠ¡å†å²** | âŒ æ—  | âœ… æ•°æ®åº“å­˜å‚¨ |
| **å¹¶å‘æ§åˆ¶** | âŒ æ—  | âœ… åç«¯ç»Ÿä¸€ç®¡ç† |
| **é”™è¯¯å¤„ç†** | âš ï¸ å‰ç«¯å¤„ç† | âœ… åç«¯ç»Ÿä¸€å¤„ç† |
| **API Key å®‰å…¨** | âŒ æš´éœ²åœ¨å‰ç«¯ | âœ… åç«¯å®‰å…¨å­˜å‚¨ |
| **è½®è¯¢ç­–ç•¥** | âš ï¸ å›ºå®šé—´éš” | âœ… æ™ºèƒ½åŠ¨æ€ï¼ˆ5-15ç§’ï¼‰|
| **URL ç®¡ç†** | âš ï¸ ä¸´æ—¶ | âœ… æŒä¹…åŒ–+åˆ·æ–° |

---

## ğŸ“‹ å®Œæ•´çš„ API è°ƒç”¨ç¤ºä¾‹

### ç”¨æˆ·æ³¨å†Œå’Œç™»å½•

```typescript
import backendAPI from '@/api/backend-api';

// æ³¨å†Œ
const user = await backendAPI.register('username', 'password', 'email@example.com');

// ç™»å½•
const { token, user: userData } = await backendAPI.login('username', 'password');

// ä¿å­˜ token
localStorage.setItem('jwt_token', token);
```

### åˆ›å»ºè§†é¢‘ä»»åŠ¡

```typescript
const token = localStorage.getItem('jwt_token');

const task = await backendAPI.createVideoTask({
  prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨æµ·è¾¹ç©è€ï¼Œå¤•é˜³è¥¿ä¸‹',
  model: 'sora_video2',
  duration: '15',
  aspectRatio: '16:9',
  referenceImage: imageBase64,  // å¯é€‰
}, token);

// task.videoId - åç«¯IDï¼ˆç”¨äºåç»­æŸ¥è¯¢ï¼‰
```

### WebSocket è®¢é˜…è¿›åº¦

```typescript
const ws = new backendAPI.BackendWebSocket();
ws.connect(token);

// ç›‘å¬è¿›åº¦æ›´æ–°
ws.on('taskProgress', (payload) => {
  updateProgressBar(payload.progress);
  console.log('åç«¯ID:', payload.videoId);
  console.log('å¤–éƒ¨ID:', payload.externalVideoId);
  console.log('æ¶ˆæ¯:', payload.message);
});

// ç›‘å¬ä»»åŠ¡å®Œæˆ
ws.on('taskCompleted', (payload) => {
  const videoUrl = payload.result.videoUrl;
  playVideo(videoUrl);
  
  // æˆ–è€…åˆ·æ–°è·å–æœ€æ–°URL
  backendAPI.refreshVideoUrl(payload.videoId, token).then(result => {
    playVideo(result.videoUrl);
  });
});

// ç›‘å¬ä»»åŠ¡å¤±è´¥
ws.on('taskFailed', (payload) => {
  showError(payload.error.message);
});

// è®¢é˜…ä»»åŠ¡
ws.subscribeTask(task.videoId);
```

### è·å–ä»»åŠ¡åˆ—è¡¨

```typescript
const { tasks, total, page, pageSize } = await backendAPI.listVideoTasks(token, {
  page: 1,
  pageSize: 20,
  status: 'COMPLETED',
  orderBy: 'createdAt',
  order: 'desc',
});

// æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨
tasks.forEach(task => {
  console.log('ä»»åŠ¡:', task.videoId);
  console.log('çŠ¶æ€:', task.status);
  console.log('è¿›åº¦:', task.progress + '%');
});
```

### è·å–å’Œåˆ·æ–°è§†é¢‘URL

```typescript
// è·å–è§†é¢‘URL
const { url, externalVideoId } = await backendAPI.getVideoUrl(videoId, token);
console.log('è§†é¢‘URL:', url);
console.log('å¤–éƒ¨ID:', externalVideoId);

// æ’­æ”¾
<video src={url} controls />

// URLè¿‡æœŸæ—¶åˆ·æ–°
try {
  playVideo(url);
} catch (error) {
  if (error.status === 404) {
    // åˆ·æ–°URL
    const { videoUrl } = await backendAPI.refreshVideoUrl(videoId, token);
    playVideo(videoUrl);
  }
}
```

---

## ğŸ¨ UI ç»„ä»¶é›†æˆç¤ºä¾‹

### è§†é¢‘ç”Ÿæˆç»„ä»¶

```typescript
// components/VideoGenerator.tsx
import { useState } from 'react';
import { Button, Progress, message } from 'antd';
import { generateVideoWithBackend, BackendWebSocket } from '@/api/backend-api';

export const VideoGenerator = () => {
  const [progress, setProgress] = useState(0);
  const [status, setStatus] = useState('');
  const [videoUrl, setVideoUrl] = useState('');
  const [ws] = useState(() => new BackendWebSocket());
  const token = localStorage.getItem('jwt_token');

  useEffect(() => {
    if (token) {
      ws.connect(token);
    }
    return () => ws.disconnect();
  }, [token]);

  const handleGenerate = async () => {
    try {
      const response = await generateVideoWithBackend(
        {
          prompt: promptInput,
          model: 'sora_video2',
          duration: '10',
          aspectRatio: '16:9',
        },
        token!,
        (prog, stat, msg) => {
          setProgress(prog);
          setStatus(msg);
        },
        ws
      );

      if (response.status === 'success') {
        setVideoUrl(response.video_url);
        message.success('è§†é¢‘ç”ŸæˆæˆåŠŸï¼');
      }
    } catch (error) {
      message.error('ç”Ÿæˆå¤±è´¥: ' + error.message);
    }
  };

  return (
    <div>
      <Button onClick={handleGenerate}>ç”Ÿæˆè§†é¢‘</Button>
      <Progress percent={progress} />
      <div>{status}</div>
      {videoUrl && <video src={videoUrl} controls />}
    </div>
  );
};
```

### ä»»åŠ¡åˆ—è¡¨ç»„ä»¶

```typescript
// components/TaskList.tsx
import { useEffect, useState } from 'react';
import { Table, Tag } from 'antd';
import backendAPI from '@/api/backend-api';

export const TaskList = () => {
  const [tasks, setTasks] = useState([]);
  const [loading, setLoading] = useState(false);
  const token = localStorage.getItem('jwt_token');

  const loadTasks = async () => {
    setLoading(true);
    try {
      const { tasks } = await backendAPI.listVideoTasks(token!, {
        page: 1,
        pageSize: 20,
      });
      setTasks(tasks);
    } catch (error) {
      console.error('åŠ è½½ä»»åŠ¡åˆ—è¡¨å¤±è´¥:', error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    loadTasks();
  }, []);

  const columns = [
    {
      title: 'ä»»åŠ¡ID',
      dataIndex: 'videoId',
      key: 'videoId',
      render: (id: string, record: any) => (
        <div>
          <div>åç«¯: {id.substring(0, 20)}...</div>
          {record.metadata?.externalTaskId && (
            <div style={{ fontSize: 12, color: '#999' }}>
              å¤–éƒ¨: {record.metadata.externalTaskId.substring(0, 20)}...
            </div>
          )}
        </div>
      ),
    },
    {
      title: 'çŠ¶æ€',
      dataIndex: 'status',
      key: 'status',
      render: (status: string) => {
        const colors = {
          QUEUED: 'default',
          PROCESSING: 'processing',
          COMPLETED: 'success',
          FAILED: 'error',
        };
        return <Tag color={colors[status]}>{status}</Tag>;
      },
    },
    {
      title: 'è¿›åº¦',
      dataIndex: 'progress',
      key: 'progress',
      render: (progress: number) => `${progress}%`,
    },
    {
      title: 'æç¤ºè¯',
      dataIndex: 'prompt',
      key: 'prompt',
      ellipsis: true,
    },
  ];

  return (
    <Table
      dataSource={tasks}
      columns={columns}
      loading={loading}
      rowKey="videoId"
    />
  );
};
```

---

## ğŸ¯ çŠ¶æ€ç®¡ç†é›†æˆï¼ˆZustandï¼‰

### Store æ‰©å±•

```typescript
// stores/videoStore.ts
import create from 'zustand';
import backendAPI, { BackendWebSocket, VideoTask } from '@/api/backend-api';

interface VideoStore {
  // WebSocket
  ws: BackendWebSocket | null;
  wsConnected: boolean;
  
  // ä»»åŠ¡
  tasks: Map<string, VideoTask>;
  currentTask: VideoTask | null;
  
  // æ–¹æ³•
  initWebSocket: (token: string) => void;
  createTask: (request: SoraRequest, token: string) => Promise<VideoTask>;
  subscribeTask: (videoId: string) => void;
  refreshUrl: (videoId: string, token: string) => Promise<string>;
}

export const useVideoStore = create<VideoStore>((set, get) => ({
  ws: null,
  wsConnected: false,
  tasks: new Map(),
  currentTask: null,

  initWebSocket: (token) => {
    const ws = new BackendWebSocket();
    
    ws.on('authSuccess', () => {
      set({ wsConnected: true });
    });

    ws.on('taskProgress', (payload) => {
      const { videoId, progress, status } = payload;
      set((state) => {
        const tasks = new Map(state.tasks);
        const task = tasks.get(videoId);
        if (task) {
          tasks.set(videoId, { ...task, progress, status });
        }
        return { tasks };
      });
    });

    ws.on('taskCompleted', (payload) => {
      const { videoId } = payload;
      set((state) => {
        const tasks = new Map(state.tasks);
        const task = tasks.get(videoId);
        if (task) {
          tasks.set(videoId, {
            ...task,
            status: 'COMPLETED',
            progress: 100,
            videoUrl: payload.result.videoUrl,
          });
        }
        return { tasks };
      });
    });

    ws.connect(token);
    set({ ws });
  },

  createTask: async (request, token) => {
    const task = await backendAPI.createVideoTask(request, token);
    
    set((state) => {
      const tasks = new Map(state.tasks);
      tasks.set(task.videoId, task);
      return { tasks, currentTask: task };
    });

    // è‡ªåŠ¨è®¢é˜…
    const ws = get().ws;
    if (ws && ws.isConnected()) {
      ws.subscribeTask(task.videoId);
    }

    return task;
  },

  subscribeTask: (videoId) => {
    const ws = get().ws;
    if (ws && ws.isConnected()) {
      ws.subscribeTask(videoId);
    }
  },

  refreshUrl: async (videoId, token) => {
    const result = await backendAPI.refreshVideoUrl(videoId, token);
    
    set((state) => {
      const tasks = new Map(state.tasks);
      const task = tasks.get(videoId);
      if (task) {
        tasks.set(videoId, {
          ...task,
          videoUrl: result.videoUrl,
        });
      }
      return { tasks };
    });

    return result.videoUrl;
  },
}));
```

---

## ğŸ“Š é›†æˆæ£€æŸ¥æ¸…å•

### åç«¯å‡†å¤‡

- [x] HTTP API æœåŠ¡è¿è¡Œ (http://localhost:3001)
- [x] WebSocket æœåŠ¡è¿è¡Œ (ws://localhost:3001/ws)
- [x] PostgreSQL æ•°æ®åº“è¿è¡Œ
- [x] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

### å‰ç«¯å‡†å¤‡

- [x] `backend-api.ts` æ–‡ä»¶å·²åˆ›å»º
- [x] `.env.local` ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] å®‰è£…ä¾èµ–ï¼ˆaxios åº”è¯¥å·²æœ‰ï¼‰
- [ ] ä¿®æ”¹è§†é¢‘ç”Ÿæˆé€»è¾‘
- [ ] æ·»åŠ  WebSocket åˆå§‹åŒ–
- [ ] æµ‹è¯•é›†æˆ

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. å¯åŠ¨æœåŠ¡

```powershell
# ç»ˆç«¯ 1 - åç«¯
cd D:\tecx\text\25\soraui_4.0\sora-ui-backend
npm run dev

# ç»ˆç«¯ 2 - å‰ç«¯
cd D:\tecx\text\25\soraui_4.0\sora-ui
npm run dev
```

### 2. æµ‹è¯•ç™»å½•

```javascript
// æµè§ˆå™¨æ§åˆ¶å° (F12)
import backendAPI from '@/api/backend-api';

const { token } = await backendAPI.login('admin', 'admin123');
console.log('Token:', token);
```

### 3. æµ‹è¯•åˆ›å»ºä»»åŠ¡

```javascript
const task = await backendAPI.createVideoTask({
  prompt: 'æµ‹è¯•è§†é¢‘',
  model: 'sora_video2',
  duration: '5',
}, token);

console.log('ä»»åŠ¡ID:', task.videoId);
```

### 4. æµ‹è¯• WebSocket

```javascript
const ws = new backendAPI.BackendWebSocket();
ws.connect(token);

ws.on('taskProgress', (payload) => {
  console.log('è¿›åº¦:', payload.progress);
});

ws.subscribeTask(task.videoId);
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: å‰ç«¯å¦‚ä½•è·å– JWT Tokenï¼Ÿ

**æ–¹å¼1**ï¼šç”¨æˆ·ç™»å½•
```typescript
const { token } = await backendAPI.login('username', 'password');
localStorage.setItem('jwt_token', token);
```

**æ–¹å¼2**ï¼šè‡ªåŠ¨æ³¨å†Œï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
```typescript
// å¦‚æœæ²¡æœ‰ tokenï¼Œå…ˆæ³¨å†Œ
if (!token) {
  const userId = generateUniqueId();
  await backendAPI.register(userId, 'defaultPassword', `${userId}@sora.local`);
  const { token } = await backendAPI.login(userId, 'defaultPassword');
  localStorage.setItem('jwt_token', token);
}
```

### Q2: CORS è·¨åŸŸé—®é¢˜ï¼Ÿ

åç«¯å·²é…ç½® CORSï¼š
```typescript
// src/app.ts
app.use(cors({
  origin: '*',  // å…è®¸æ‰€æœ‰æ¥æº
  credentials: true,
}));
```

### Q3: WebSocket æ–­çº¿é‡è¿ï¼Ÿ

`BackendWebSocket` ç±»å·²å†…ç½®è‡ªåŠ¨é‡è¿ï¼š
- æŒ‡æ•°é€€é¿ç­–ç•¥
- æœ€å¤šé‡è¿ 10 æ¬¡
- è‡ªåŠ¨é‡æ–°è®¤è¯

---

## ğŸ“š ä¸‹ä¸€æ­¥

### å¿…é¡»å®Œæˆ

1. **ä¿®æ”¹å‰ç«¯è§†é¢‘ç”Ÿæˆé€»è¾‘** - ä½¿ç”¨ `backend-api.ts`
2. **æ·»åŠ ç”¨æˆ·è®¤è¯ç•Œé¢** - ç™»å½•/æ³¨å†Œ
3. **åˆå§‹åŒ– WebSocket** - åº”ç”¨å¯åŠ¨æ—¶è¿æ¥

### å¯é€‰å¢å¼º

1. **ä»»åŠ¡å†å²é¡µé¢** - æ˜¾ç¤ºæ‰€æœ‰å†å²ä»»åŠ¡
2. **å®æ—¶ä»»åŠ¡ç›‘æ§** - æµ®åŠ¨çª—å£æ˜¾ç¤ºè¿›è¡Œä¸­çš„ä»»åŠ¡
3. **æ‰¹é‡æ“ä½œ** - æ‰¹é‡åˆ é™¤/é‡è¯•ä»»åŠ¡

---

## ğŸŠ é›†æˆä¼˜åŠ¿æ€»ç»“

**å·²å®ç°**ï¼š
- âœ… å®Œæ•´çš„åç«¯ API å®¢æˆ·ç«¯
- âœ… WebSocket å®æ—¶æ¨é€é›†æˆ
- âœ… è®¤è¯ç³»ç»Ÿ
- âœ… ä»»åŠ¡ç®¡ç†åŠŸèƒ½
- âœ… æ™ºèƒ½è½®è¯¢ç­–ç•¥
- âœ… URL åˆ·æ–°åŠŸèƒ½

**å‰ç«¯åªéœ€**ï¼š
1. å¯¼å…¥ `backend-api.ts`
2. æ›¿æ¢åŸæœ‰çš„ API è°ƒç”¨
3. åˆå§‹åŒ– WebSocket
4. è®¢é˜…ä»»åŠ¡è¿›åº¦

**ç”¨æˆ·ä½“éªŒæå‡**ï¼š
- ğŸš€ å®æ—¶è¿›åº¦ï¼ˆ<100msï¼‰
- ğŸ“Š ä»»åŠ¡å†å²è¿½è¸ª
- ğŸ” å®‰å…¨è®¤è¯
- ğŸ”„ URL è‡ªåŠ¨åˆ·æ–°

**å‡†å¤‡å¥½å¼€å§‹ä¿®æ”¹å‰ç«¯ä»£ç äº†å—ï¼Ÿ** ğŸš€


