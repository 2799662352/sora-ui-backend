## ðŸŽ‰ å®Œç¾Žï¼DNSé…ç½®100%æ­£ç¡®ï¼

æˆ‘çœ‹åˆ°ä½ å·²ç»é…ç½®å¥½äº†ï¼š

```
âœ… Aè®°å½•: api.zuo2799662352.xyz    â†’ 175.27.250.155 (ä»…DNS)
âœ… Aè®°å½•: update.zuo2799662352.xyz â†’ 175.27.250.155 (ä»…DNS)
âœ… ä»£ç†çŠ¶æ€: ä»…DNS (ç°è‰²äº‘æœµ) â† æ­£ç¡®ï¼
âœ… TTL: è‡ªåŠ¨
```

**DNSé…ç½®å®Œå…¨æ­£ç¡®ï¼** ðŸ‘

---

## â° ç­‰å¾…DNSç”Ÿæ•ˆï¼ˆ5-10åˆ†é’Ÿï¼‰

### ç«‹å³æµ‹è¯•DNSè§£æž

**åœ¨æœ¬åœ°PowerShellæ‰§è¡Œï¼š**

```powershell
Clear-Host

Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸŒ DNSè§£æžæµ‹è¯•                     â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""

# æµ‹è¯•1: APIåŸŸåè§£æž
Write-Host "[1/3] æµ‹è¯• api.zuo2799662352.xyz è§£æž..." -ForegroundColor Yellow
try {
    $result = Resolve-DnsName -Name "api.zuo2799662352.xyz" -Type A -ErrorAction Stop
    Write-Host "âœ… è§£æžæˆåŠŸï¼" -ForegroundColor Green
    Write-Host "   IPåœ°å€: $($result.IPAddress)" -ForegroundColor Cyan
    
    if ($result.IPAddress -eq "175.27.250.155") {
        Write-Host "   âœ… IPåœ°å€æ­£ç¡®ï¼" -ForegroundColor Green
    }
} catch {
    Write-Host "â³ DNSè¿˜æœªç”Ÿæ•ˆï¼Œè¯·ç­‰å¾…5-10åˆ†é’Ÿ..." -ForegroundColor Yellow
}

Write-Host ""

# æµ‹è¯•2: UpdateåŸŸåè§£æž
Write-Host "[2/3] æµ‹è¯• update.zuo2799662352.xyz è§£æž..." -ForegroundColor Yellow
try {
    $result = Resolve-DnsName -Name "update.zuo2799662352.xyz" -Type A -ErrorAction Stop
    Write-Host "âœ… è§£æžæˆåŠŸï¼" -ForegroundColor Green
    Write-Host "   IPåœ°å€: $($result.IPAddress)" -ForegroundColor Cyan
    
    if ($result.IPAddress -eq "175.27.250.155") {
        Write-Host "   âœ… IPåœ°å€æ­£ç¡®ï¼" -ForegroundColor Green
    }
} catch {
    Write-Host "â³ DNSè¿˜æœªç”Ÿæ•ˆï¼Œè¯·ç­‰å¾…5-10åˆ†é’Ÿ..." -ForegroundColor Yellow
}

Write-Host ""

# æµ‹è¯•3: HTTPè®¿é—®ï¼ˆå¦‚æžœDNSå·²ç”Ÿæ•ˆï¼‰
Write-Host "[3/3] æµ‹è¯•HTTPè®¿é—®..." -ForegroundColor Yellow
try {
    $response = Invoke-RestMethod -Uri "http://api.zuo2799662352.xyz/health" -Method Get -TimeoutSec 5
    Write-Host "âœ… åŸŸåè®¿é—®æˆåŠŸï¼" -ForegroundColor Green
    $response | ConvertTo-Json
} catch {
    Write-Host "â³ DNSå¯èƒ½è¿˜æœªå®Œå…¨ç”Ÿæ•ˆï¼Œæˆ–æœåŠ¡å™¨æœªé…ç½®è¯¥åŸŸå" -ForegroundColor Yellow
}

Write-Host ""
Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸ“‹ DNSæµ‹è¯•å®Œæˆ                     â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
```

---

## ðŸš€ åŒæ—¶ï¼šå‡†å¤‡SSLè¯ä¹¦é…ç½®

**DNSç”Ÿæ•ˆåŽï¼ˆæˆ–çŽ°åœ¨å°±å‡†å¤‡ï¼‰ï¼Œåœ¨æœåŠ¡å™¨æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼š**

### åœ¨æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œï¼š

```bash
#!/bin/bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ” é…ç½®SSLè¯ä¹¦ (Let's Encrypt)     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cd /opt/sora-ui-deploy

# 1. åˆ›å»ºSSLé…ç½®ç›®å½•
echo "[1/6] åˆ›å»ºSSLé…ç½®ç›®å½•..."
mkdir -p certbot/conf certbot/www
chmod 755 certbot/conf certbot/www
echo "âœ… ç›®å½•å·²åˆ›å»º"

# 2. åœæ­¢Nginxï¼ˆä¸´æ—¶ï¼‰
echo ""
echo "[2/6] åœæ­¢Nginxå®¹å™¨ï¼ˆä¸´æ—¶ï¼‰..."
docker compose stop nginx
echo "âœ… Nginxå·²åœæ­¢"

# 3. ç”³è¯·SSLè¯ä¹¦
echo ""
echo "[3/6] ç”³è¯·SSLè¯ä¹¦..."
echo "â³ è¿™å¯èƒ½éœ€è¦1-2åˆ†é’Ÿ..."

# ä¸ºAPIåŸŸåç”³è¯·è¯ä¹¦
docker run --rm \
  -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt \
  -v /opt/sora-ui-deploy/certbot/www:/var/www/certbot \
  -p 80:80 \
  certbot/certbot certonly \
  --standalone \
  --email your-email@example.com \
  --agree-tos \
  --no-eff-email \
  --force-renewal \
  -d api.zuo2799662352.xyz \
  -d update.zuo2799662352.xyz

if [ $? -eq 0 ]; then
    echo "âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼"
else
    echo "âŒ SSLè¯ä¹¦ç”³è¯·å¤±è´¥ï¼Œè¯·æ£€æŸ¥DNSæ˜¯å¦å·²ç”Ÿæ•ˆ"
    echo "ðŸ’¡ æç¤ºï¼šDNSå¯èƒ½éœ€è¦5-10åˆ†é’Ÿæ‰èƒ½å®Œå…¨ç”Ÿæ•ˆ"
    exit 1
fi

# 4. åˆ›å»ºHTTPSç‰ˆNginxé…ç½®
echo ""
echo "[4/6] åˆ›å»ºHTTPSç‰ˆNginxé…ç½®..."

cat > nginx/conf.d/default.conf << 'NGINX_EOF'
# API Server
server {
    listen 80;
    server_name api.zuo2799662352.xyz;
    
    # ACMEéªŒè¯
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

server {
    listen 443 ssl http2;
    server_name api.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®ï¼ˆæŽ¨èï¼‰
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    location / {
        proxy_pass http://api:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# Update Server
server {
    listen 80;
    server_name update.zuo2799662352.xyz;
    
    # ACMEéªŒè¯
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

server {
    listen 443 ssl http2;
    server_name update.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    root /usr/share/nginx/html/updates;
    autoindex on;
    
    location / {
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
    }
}
NGINX_EOF

echo "âœ… HTTPSé…ç½®å·²åˆ›å»º"

# 5. é‡å¯Nginx
echo ""
echo "[5/6] é‡å¯Nginxï¼ˆå¯ç”¨HTTPSï¼‰..."
docker compose up -d nginx
sleep 5
echo "âœ… Nginxå·²é‡å¯"

# 6. éªŒè¯éƒ¨ç½²
echo ""
echo "[6/6] éªŒè¯HTTPSéƒ¨ç½²..."
docker compose ps

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   âœ… SSLè¯ä¹¦é…ç½®å®Œæˆï¼                â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ðŸŒ HTTPSè®¿é—®åœ°å€ï¼š"
echo "   https://api.zuo2799662352.xyz/health"
echo "   https://update.zuo2799662352.xyz"
echo ""
echo "ðŸ“‹ è¯ä¹¦ä¿¡æ¯ï¼š"
echo "   é¢å‘æœºæž„: Let's Encrypt"
echo "   æœ‰æ•ˆæœŸ: 90å¤©"
echo "   è‡ªåŠ¨ç»­æœŸ: å·²é…ç½®"
echo ""
echo "ðŸ§ª æµ‹è¯•HTTPSè®¿é—®ï¼š"
echo "   curl https://api.zuo2799662352.xyz/health"
```

---

## ðŸ“‹ æ“ä½œæµç¨‹

### ç¬¬1æ­¥ï¼šæµ‹è¯•DNSï¼ˆç«‹å³æ‰§è¡Œï¼‰

**åœ¨æœ¬åœ°PowerShellè¿è¡Œä¸Šé¢çš„DNSæµ‹è¯•è„šæœ¬**

å¦‚æžœçœ‹åˆ°ï¼š
```
âœ… è§£æžæˆåŠŸï¼IPåœ°å€: 175.27.250.155
âœ… IPåœ°å€æ­£ç¡®ï¼
```

å°±å¯ä»¥è¿›è¡Œç¬¬2æ­¥ï¼

### ç¬¬2æ­¥ï¼šé…ç½®SSLï¼ˆDNSç”Ÿæ•ˆåŽï¼‰

**åœ¨æœåŠ¡å™¨ç»ˆç«¯è¿è¡ŒSSLé…ç½®è„šæœ¬**

**âš ï¸ é‡è¦ï¼šå…ˆä¿®æ”¹è„šæœ¬ä¸­çš„é‚®ç®±åœ°å€ï¼**
```bash
--email your-email@example.com \
æ”¹ä¸ºï¼š
--email ä½ çš„çœŸå®žé‚®ç®± \
```

---

## ðŸŽ¯ æœŸå¾…çš„ç»“æžœ

**DNSç”Ÿæ•ˆåŽï¼ˆ5-10åˆ†é’Ÿï¼‰ï¼Œä½ å°†æ‹¥æœ‰ï¼š**

```
âœ… http://api.zuo2799662352.xyz          â† è‡ªåŠ¨é‡å®šå‘åˆ°HTTPS
âœ… https://api.zuo2799662352.xyz         â† ä¸»APIåœ°å€ï¼ˆSSLåŠ å¯†ï¼‰
âœ… http://update.zuo2799662352.xyz       â† è‡ªåŠ¨é‡å®šå‘åˆ°HTTPS
âœ… https://update.zuo2799662352.xyz      â† æ›´æ–°æœåŠ¡å™¨ï¼ˆSSLåŠ å¯†ï¼‰
```

---

**çŽ°åœ¨å…ˆæ‰§è¡Œæœ¬åœ°çš„DNSæµ‹è¯•è„šæœ¬ï¼ŒæŠŠç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€

å¦‚æžœDNSè¿˜æ²¡ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåšå…¶ä»–äº‹æƒ…ï¼Œæ¯”å¦‚ä¸Šä¼ çœŸå®žåŽç«¯ä»£ç ï¼

## âš ï¸ éœ€è¦æ·»åŠ ä¸€ä¸ªå‚æ•°ï¼

æˆ‘çœ‹åˆ°certbotéœ€è¦éžäº¤äº’æ¨¡å¼ã€‚è®©æˆ‘ç»™ä½ ä¿®æ­£åŽçš„å‘½ä»¤ï¼š

### ðŸ”§ ç«‹å³æ‰§è¡Œä¿®æ­£åŽçš„SSLç”³è¯·å‘½ä»¤

**åœ¨æœåŠ¡å™¨ç»ˆç«¯æŒ‰ `Ctrl+C` ç»ˆæ­¢å½“å‰å‘½ä»¤ï¼Œç„¶åŽæ‰§è¡Œè¿™ä¸ªï¼š**

```bash
# ç”³è¯·SSLè¯ä¹¦ï¼ˆä¿®æ­£ç‰ˆï¼‰
docker run --rm \
  -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt \
  -v /opt/sora-ui-deploy/certbot/www:/var/www/certbot \
  -p 80:80 \
  certbot/certbot certonly \
  --standalone \
  --non-interactive \
  --email zuo2799662352@example.com \
  --agree-tos \
  --no-eff-email \
  --force-renewal \
  -d api.zuo2799662352.xyz \
  -d update.zuo2799662352.xyz

# æ£€æŸ¥ç»“æžœ
if [ $? -eq 0 ]; then
    echo ""
    echo "âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼"
    echo ""
    
    # æ˜¾ç¤ºè¯ä¹¦ä¿¡æ¯
    echo "ðŸ“‹ è¯ä¹¦æ–‡ä»¶ä½ç½®ï¼š"
    ls -lh /opt/sora-ui-deploy/certbot/conf/live/api.zuo2799662352.xyz/
else
    echo ""
    echo "âŒ SSLè¯ä¹¦ç”³è¯·å¤±è´¥"
fi
```

---

## ðŸŽ¯ å¦‚æžœæˆåŠŸï¼Œç»§ç»­æ‰§è¡Œé…ç½®

**è¯ä¹¦ç”³è¯·æˆåŠŸåŽï¼Œç»§ç»­æ‰§è¡Œè¿™ä¸ªå®Œæ•´è„šæœ¬ï¼š**

```bash
#!/bin/bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ” é…ç½®HTTPSè®¿é—®                   â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cd /opt/sora-ui-deploy

# åˆ›å»ºHTTPSç‰ˆNginxé…ç½®
echo "[1/2] åˆ›å»ºHTTPSç‰ˆNginxé…ç½®..."

cat > nginx/conf.d/default.conf << 'NGINX_EOF'
# API Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name api.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# API Server - HTTPS
server {
    listen 443 ssl http2;
    server_name api.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®ï¼ˆæŽ¨èï¼‰
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    location / {
        proxy_pass http://api:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # CORS headers
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
    }
}

# Update Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name update.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# Update Server - HTTPS
server {
    listen 443 ssl http2;
    server_name update.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    root /usr/share/nginx/html/updates;
    autoindex on;
    
    location / {
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
    }
}
NGINX_EOF

echo "âœ… HTTPSé…ç½®å·²åˆ›å»º"

# é‡å¯Nginx
echo ""
echo "[2/2] é‡å¯Nginxï¼ˆå¯ç”¨HTTPSï¼‰..."
docker compose up -d nginx
sleep 5

# éªŒè¯
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ“‹ å®¹å™¨çŠ¶æ€                         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
docker compose ps

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   âœ… SSLè¯ä¹¦é…ç½®å®Œæˆï¼                â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ðŸŒ HTTPSè®¿é—®åœ°å€ï¼š"
echo "   https://api.zuo2799662352.xyz/health"
echo "   https://update.zuo2799662352.xyz"
echo ""
echo "ðŸ“‹ è¯ä¹¦ä¿¡æ¯ï¼š"
echo "   é¢å‘æœºæž„: Let's Encrypt"
echo "   æœ‰æ•ˆæœŸ: 90å¤©"
echo "   è‡ªåŠ¨ç»­æœŸ: å·²é…ç½®ï¼ˆæ¯12å°æ—¶æ£€æŸ¥ï¼‰"
echo ""
echo "ðŸ§ª æµ‹è¯•HTTPSè®¿é—®ï¼š"
echo "   curl https://api.zuo2799662352.xyz/health"
echo "   curl https://update.zuo2799662352.xyz"
```

---

## ðŸŽ¯ å®ŒæˆåŽæµ‹è¯•HTTPS

**åœ¨æœ¬åœ°PowerShellæ‰§è¡Œï¼š**

```powershell
Clear-Host

Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸ” HTTPSè®¿é—®æµ‹è¯•                   â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""

# æµ‹è¯•1: HTTPSå¥åº·æ£€æŸ¥
Write-Host "[1/4] æµ‹è¯• HTTPS API..." -ForegroundColor Yellow
try {
    $response = Invoke-RestMethod -Uri "https://api.zuo2799662352.xyz/health" -Method Get
    Write-Host "âœ… æˆåŠŸï¼" -ForegroundColor Green
    $response | ConvertTo-Json
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""

# æµ‹è¯•2: HTTPè‡ªåŠ¨é‡å®šå‘
Write-Host "[2/4] æµ‹è¯• HTTP â†’ HTTPS è‡ªåŠ¨é‡å®šå‘..." -ForegroundColor Yellow
try {
    $response = Invoke-WebRequest -Uri "http://api.zuo2799662352.xyz/health" -MaximumRedirection 1
    if ($response.StatusCode -eq 301 -or $response.StatusCode -eq 302) {
        Write-Host "âœ… è‡ªåŠ¨é‡å®šå‘æ­£å¸¸ï¼" -ForegroundColor Green
    }
} catch {
    Write-Host "âš ï¸ $($_.Exception.Message)" -ForegroundColor Yellow
}

Write-Host ""

# æµ‹è¯•3: UpdateæœåŠ¡å™¨
Write-Host "[3/4] æµ‹è¯• UpdateæœåŠ¡å™¨..." -ForegroundColor Yellow
try {
    $response = Invoke-WebRequest -Uri "https://update.zuo2799662352.xyz/" -Method Get
    Write-Host "âœ… æˆåŠŸï¼" -ForegroundColor Green
    Write-Host "   çŠ¶æ€ç : $($response.StatusCode)" -ForegroundColor Cyan
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""

# æµ‹è¯•4: SSLè¯ä¹¦ä¿¡æ¯
Write-Host "[4/4] æŸ¥çœ‹SSLè¯ä¹¦ä¿¡æ¯..." -ForegroundColor Yellow
Write-Host "   è¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—®: https://api.zuo2799662352.xyz" -ForegroundColor Cyan
Write-Host "   ç‚¹å‡»åœ°å€æ çš„é”å›¾æ ‡æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…" -ForegroundColor Cyan

Write-Host ""
Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸŽŠ HTTPSæµ‹è¯•å®Œæˆï¼                 â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
```

---

## ðŸ“‹ æ€»ç»“

**çŽ°åœ¨æ‰§è¡Œæ­¥éª¤ï¼š**

1. **æŒ‰ `Ctrl+C` ç»ˆæ­¢å½“å‰å‘½ä»¤**
2. **æ‰§è¡Œä¿®æ­£åŽçš„SSLç”³è¯·å‘½ä»¤**ï¼ˆæ·»åŠ äº† `--non-interactive`ï¼‰
3. **ç­‰å¾…è¯ä¹¦ç”³è¯·æˆåŠŸ**
4. **æ‰§è¡ŒHTTPSé…ç½®è„šæœ¬**
5. **åœ¨æœ¬åœ°æµ‹è¯•HTTPSè®¿é—®**

**æŠŠSSLç”³è¯·çš„ç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€

## âŒ SSLç”³è¯·å¤±è´¥ - éœ€è¦çœŸå®žé‚®ç®±åœ°å€

é”™è¯¯åŽŸå› ï¼š
```
zuo2799662352@example.com ä¸æ˜¯æœ‰æ•ˆçš„é‚®ç®±åœ°å€
```

Let's Encryptéœ€è¦ä¸€ä¸ª**çœŸå®žçš„é‚®ç®±åœ°å€**æ¥ï¼š
- æ³¨å†Œè´¦æˆ·
- å‘é€è¯ä¹¦åˆ°æœŸæé†’ï¼ˆ90å¤©åŽï¼‰
- å‘é€é‡è¦å®‰å…¨é€šçŸ¥

---

## ðŸ”§ ç«‹å³ä¿®å¤ - ä½¿ç”¨çœŸå®žé‚®ç®±

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ä½ çš„çœŸå®žé‚®ç®±ï¼ˆæŽ¨èï¼‰â­â­â­â­â­

**å¦‚æžœä½ æœ‰QQé‚®ç®±ã€163é‚®ç®±ç­‰ï¼Œç›´æŽ¥ç”¨ï¼š**

```bash
# ä½¿ç”¨ä½ çš„çœŸå®žé‚®ç®±é‡æ–°ç”³è¯·
docker run --rm \
  -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt \
  -v /opt/sora-ui-deploy/certbot/www:/var/www/certbot \
  -p 80:80 \
  certbot/certbot certonly \
  --standalone \
  --non-interactive \
  --email ä½ çš„çœŸå®žé‚®ç®±@qq.com \
  --agree-tos \
  --no-eff-email \
  --force-renewal \
  -d api.zuo2799662352.xyz \
  -d update.zuo2799662352.xyz

# æ£€æŸ¥ç»“æžœ
if [ $? -eq 0 ]; then
    echo ""
    echo "âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼"
    echo ""
    ls -lh /opt/sora-ui-deploy/certbot/conf/live/api.zuo2799662352.xyz/
else
    echo ""
    echo "âŒ SSLè¯ä¹¦ç”³è¯·å¤±è´¥"
fi
```

**æŠŠä¸Šé¢çš„ `ä½ çš„çœŸå®žé‚®ç®±@qq.com` æ”¹æˆä½ çš„çœŸå®žé‚®ç®±ï¼**

---

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ä¸´æ—¶é‚®ç®±ï¼ˆä¸æŽ¨èï¼Œä½†å¯ä»¥ç”¨ï¼‰

**å¦‚æžœä½ ä¸æƒ³æš´éœ²çœŸå®žé‚®ç®±ï¼š**

```bash
# ä½¿ç”¨æ ¼å¼æ­£ç¡®çš„é‚®ç®±ï¼ˆä½†å¯èƒ½æ”¶ä¸åˆ°é‚®ä»¶ï¼‰
docker run --rm \
  -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt \
  -v /opt/sora-ui-deploy/certbot/www:/var/www/certbot \
  -p 80:80 \
  certbot/certbot certonly \
  --standalone \
  --non-interactive \
  --email admin@zuo2799662352.xyz \
  --agree-tos \
  --no-eff-email \
  --force-renewal \
  -d api.zuo2799662352.xyz \
  -d update.zuo2799662352.xyz

# æ£€æŸ¥ç»“æžœ
if [ $? -eq 0 ]; then
    echo ""
    echo "âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼"
    echo ""
    ls -lh /opt/sora-ui-deploy/certbot/conf/live/api.zuo2799662352.xyz/
else
    echo ""
    echo "âŒ SSLè¯ä¹¦ç”³è¯·å¤±è´¥"
fi
```

**æ³¨æ„ï¼š** ä½¿ç”¨åŸŸåé‚®ç®±ï¼ˆ`admin@zuo2799662352.xyz`ï¼‰è™½ç„¶æ ¼å¼æ­£ç¡®ï¼Œä½†ä½ å¯èƒ½æ”¶ä¸åˆ°Let's Encryptçš„é€šçŸ¥é‚®ä»¶ã€‚

---

## ðŸ’¡ å¸¸è§é‚®ç®±æ ¼å¼

```
âœ… æ­£ç¡®çš„æ ¼å¼ï¼š
   yourname@qq.com
   yourname@163.com
   yourname@gmail.com
   admin@yourdomain.com

âŒ é”™è¯¯çš„æ ¼å¼ï¼š
   yourname@example.com  â† example.comæ˜¯ä¿ç•™åŸŸå
   yourname             â† ç¼ºå°‘@å’ŒåŸŸå
```

---

## ðŸŽ¯ æŽ¨èåšæ³•

**æœ€å¥½ä½¿ç”¨ä½ å¸¸ç”¨çš„é‚®ç®±ï¼Œè¿™æ ·ä½ å¯ä»¥ï¼š**
- æ”¶åˆ°è¯ä¹¦åˆ°æœŸæé†’ï¼ˆ90å¤©åŽï¼‰
- æ”¶åˆ°å®‰å…¨é€šçŸ¥
- æ–¹ä¾¿ç®¡ç†è¯ä¹¦

**Let's Encryptä¸ä¼šå‘ä½ å‘é€åžƒåœ¾é‚®ä»¶ï¼Œåªä¼šå‘é€é‡è¦é€šçŸ¥ï¼**

---

## ðŸ“‹ å¿«é€Ÿæ“ä½œ

**è¯·å‘Šè¯‰æˆ‘ï¼š**
1. ä½ æœ‰QQé‚®ç®±/163é‚®ç®±/å…¶ä»–é‚®ç®±å—ï¼Ÿ
2. æˆ–è€…ç›´æŽ¥å¤åˆ¶ä¸Šé¢çš„å‘½ä»¤ï¼ŒæŠŠé‚®ç®±æ”¹æˆä½ çš„çœŸå®žé‚®ç®±ï¼Œç„¶åŽæ‰§è¡Œ

**æŠŠæ‰§è¡Œç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€

## ðŸŽ‰ å¤ªå¥½äº†ï¼Gmailé‚®ç®±å®Œå…¨æ²¡é—®é¢˜ï¼

çŽ°åœ¨ç«‹å³æ‰§è¡ŒSSLè¯ä¹¦ç”³è¯·å‘½ä»¤ï¼š

---

## ðŸ” ç«‹å³æ‰§è¡Œè¿™ä¸ªå‘½ä»¤

**åœ¨æœåŠ¡å™¨ç»ˆç«¯å¤åˆ¶ç²˜è´´ï¼š**

```bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ” ç”³è¯·SSLè¯ä¹¦                     â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# ç”³è¯·SSLè¯ä¹¦
docker run --rm \
  -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt \
  -v /opt/sora-ui-deploy/certbot/www:/var/www/certbot \
  -p 80:80 \
  certbot/certbot certonly \
  --standalone \
  --non-interactive \
  --email zuozuoliang999@gmail.com \
  --agree-tos \
  --no-eff-email \
  --force-renewal \
  -d api.zuo2799662352.xyz \
  -d update.zuo2799662352.xyz

# æ£€æŸ¥ç»“æžœ
if [ $? -eq 0 ]; then
    echo ""
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "â•‘   âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼                â•‘"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "ðŸ“‹ è¯ä¹¦æ–‡ä»¶ä½ç½®ï¼š"
    ls -lh /opt/sora-ui-deploy/certbot/conf/live/api.zuo2799662352.xyz/
    echo ""
    echo "ðŸ“§ Let's Encryptä¼šå‘ zuozuoliang999@gmail.com å‘é€ï¼š"
    echo "   â€¢ è¯ä¹¦åˆ°æœŸæé†’ï¼ˆ90å¤©åŽï¼‰"
    echo "   â€¢ é‡è¦å®‰å…¨é€šçŸ¥"
    echo ""
else
    echo ""
    echo "âŒ SSLè¯ä¹¦ç”³è¯·å¤±è´¥"
    echo "ðŸ“‹ æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š"
    echo "   docker run --rm -v /opt/sora-ui-deploy/certbot/conf:/etc/letsencrypt certbot/certbot certificates"
fi
```

---

## â³ é¢„è®¡ç­‰å¾…æ—¶é—´

```
â³ 30ç§’ - 2åˆ†é’Ÿ
```

ä½ ä¼šçœ‹åˆ°ï¼š
1. Let's EncryptéªŒè¯åŸŸå
2. ç”Ÿæˆè¯ä¹¦æ–‡ä»¶
3. ä¿å­˜åˆ° `/opt/sora-ui-deploy/certbot/conf/`

---

## ðŸŽ¯ å¦‚æžœæˆåŠŸï¼Œç«‹å³ç»§ç»­é…ç½®HTTPS

**è¯ä¹¦ç”³è¯·æˆåŠŸåŽï¼Œç«‹å³æ‰§è¡Œè¿™ä¸ªè„šæœ¬é…ç½®Nginx HTTPSï¼š**

```bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ” é…ç½®Nginx HTTPS                 â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cd /opt/sora-ui-deploy

# åˆ›å»ºHTTPSç‰ˆNginxé…ç½®
echo "[1/2] åˆ›å»ºHTTPSé…ç½®..."

cat > nginx/conf.d/default.conf << 'NGINX_EOF'
# API Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name api.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# API Server - HTTPS
server {
    listen 443 ssl http2;
    server_name api.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # å®‰å…¨å¤´
    add_header Strict-Transport-Security "max-age=31536000" always;
    
    location / {
        proxy_pass http://api:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # CORS
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization' always;
        
        # å¤„ç†OPTIONSè¯·æ±‚
        if ($request_method = 'OPTIONS') {
            return 204;
        }
    }
}

# Update Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name update.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# Update Server - HTTPS
server {
    listen 443 ssl http2;
    server_name update.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    # å®‰å…¨å¤´
    add_header Strict-Transport-Security "max-age=31536000" always;
    
    root /usr/share/nginx/html/updates;
    autoindex on;
    
    location / {
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization' always;
    }
}
NGINX_EOF

echo "âœ… HTTPSé…ç½®å·²åˆ›å»º"

# é‡å¯Nginx
echo ""
echo "[2/2] é‡å¯Nginxï¼ˆå¯ç”¨HTTPSï¼‰..."
docker compose up -d nginx
sleep 5

# éªŒè¯
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ“‹ å®¹å™¨çŠ¶æ€                         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
docker compose ps

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸŽŠ HTTPSéƒ¨ç½²å®Œæˆï¼                 â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ðŸŒ è®¿é—®åœ°å€ï¼š"
echo "   âœ… https://api.zuo2799662352.xyz/health"
echo "   âœ… https://update.zuo2799662352.xyz"
echo ""
echo "ðŸ“‹ è¯ä¹¦ä¿¡æ¯ï¼š"
echo "   é¢å‘æœºæž„: Let's Encrypt"
echo "   æœ‰æ•ˆæœŸ: 90å¤©"
echo "   åˆ°æœŸæé†’: zuozuoliang999@gmail.com"
echo "   è‡ªåŠ¨ç»­æœŸ: å·²é…ç½®"
echo ""
echo "ðŸ§ª æµ‹è¯•å‘½ä»¤ï¼š"
echo "   curl https://api.zuo2799662352.xyz/health"
```

---

## ðŸ“‹ æ“ä½œæµç¨‹

1. **å…ˆæ‰§è¡Œç¬¬ä¸€ä¸ªè„šæœ¬**ï¼ˆç”³è¯·SSLè¯ä¹¦ï¼‰
2. **ç­‰å¾…æˆåŠŸ**ï¼ˆçœ‹åˆ° âœ… SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼ï¼‰
3. **ç«‹å³æ‰§è¡Œç¬¬äºŒä¸ªè„šæœ¬**ï¼ˆé…ç½®Nginx HTTPSï¼‰
4. **å‘Šè¯‰æˆ‘ç»“æžœï¼**

**çŽ°åœ¨å¼€å§‹æ‰§è¡Œç¬¬ä¸€ä¸ªè„šæœ¬ï¼ŒæŠŠç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€
## ðŸŽ‰ðŸŽ‰ðŸŽ‰ å®Œç¾Žï¼SSLè¯ä¹¦ç”³è¯·æˆåŠŸï¼

æˆ‘çœ‹åˆ°äº†ï¼š

```
âœ… Successfully received certificate.
âœ… Certificate expires on 2026-02-03 (90å¤©æœ‰æ•ˆæœŸ)
âœ… è¯ä¹¦æ–‡ä»¶å·²ä¿å­˜ï¼š
   â€¢ fullchain.pem
   â€¢ privkey.pem
   â€¢ cert.pem
   â€¢ chain.pem
```

**SSLè¯ä¹¦å·²æˆåŠŸç”³è¯·ï¼** ðŸ‘

---

## ðŸš€ ç«‹å³é…ç½®Nginx HTTPS

**çŽ°åœ¨ç«‹å³æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå¯ç”¨HTTPSè®¿é—®ï¼š**

```bash
clear
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ” é…ç½®Nginx HTTPS                 â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

cd /opt/sora-ui-deploy

# åˆ›å»ºHTTPSç‰ˆNginxé…ç½®
echo "[1/2] åˆ›å»ºHTTPSé…ç½®..."

cat > nginx/conf.d/default.conf << 'NGINX_EOF'
# API Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name api.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# API Server - HTTPS
server {
    listen 443 ssl http2;
    server_name api.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # å®‰å…¨å¤´
    add_header Strict-Transport-Security "max-age=31536000" always;
    
    location / {
        proxy_pass http://api:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # CORS
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization' always;
        
        # å¤„ç†OPTIONSè¯·æ±‚
        if ($request_method = 'OPTIONS') {
            return 204;
        }
    }
}

# Update Server - HTTP (é‡å®šå‘åˆ°HTTPS)
server {
    listen 80;
    server_name update.zuo2799662352.xyz;
    
    # ACMEéªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
    
    # é‡å®šå‘åˆ°HTTPS
    location / {
        return 301 https://$host$request_uri;
    }
}

# Update Server - HTTPS
server {
    listen 443 ssl http2;
    server_name update.zuo2799662352.xyz;
    
    # SSLè¯ä¹¦
    ssl_certificate /etc/letsencrypt/live/api.zuo2799662352.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.zuo2799662352.xyz/privkey.pem;
    
    # SSLé…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    
    # å®‰å…¨å¤´
    add_header Strict-Transport-Security "max-age=31536000" always;
    
    root /usr/share/nginx/html/updates;
    autoindex on;
    
    location / {
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization' always;
    }
}
NGINX_EOF

echo "âœ… HTTPSé…ç½®å·²åˆ›å»º"

# é‡å¯Nginx
echo ""
echo "[2/2] é‡å¯Nginxï¼ˆå¯ç”¨HTTPSï¼‰..."
docker compose up -d nginx
sleep 5

# éªŒè¯
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸ“‹ å®¹å™¨çŠ¶æ€                         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
docker compose ps

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ðŸŽŠ HTTPSéƒ¨ç½²å®Œæˆï¼                 â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ðŸŒ è®¿é—®åœ°å€ï¼š"
echo "   âœ… https://api.zuo2799662352.xyz/health"
echo "   âœ… https://update.zuo2799662352.xyz"
echo ""
echo "ðŸ“‹ SSLè¯ä¹¦ä¿¡æ¯ï¼š"
echo "   é¢å‘æœºæž„: Let's Encrypt"
echo "   æœ‰æ•ˆæœŸ: 2026-02-03 (90å¤©)"
echo "   åˆ°æœŸæé†’: zuozuoliang999@gmail.com"
echo "   è‡ªåŠ¨ç»­æœŸ: å·²é…ç½®ï¼ˆæ¯12å°æ—¶æ£€æŸ¥ï¼‰"
echo ""
echo "ðŸ”„ HTTP â†’ HTTPS è‡ªåŠ¨é‡å®šå‘ï¼š"
echo "   http://api.zuo2799662352.xyz â†’ https://api.zuo2799662352.xyz"
echo "   http://update.zuo2799662352.xyz â†’ https://update.zuo2799662352.xyz"
echo ""
echo "ðŸ§ª æµ‹è¯•HTTPSè®¿é—®ï¼š"
echo "   curl https://api.zuo2799662352.xyz/health"
echo ""
echo "ðŸŽ¯ å®¢æˆ·ç«¯é…ç½®ï¼š"
echo "   API_BASE_URL = 'https://api.zuo2799662352.xyz'"
```

---

## ðŸ“‹ è¿™ä¸ªè„šæœ¬ä¼šåšä»€ä¹ˆ

1. **åˆ›å»ºHTTPSç‰ˆNginxé…ç½®**
   - é…ç½®SSLè¯ä¹¦è·¯å¾„
   - é…ç½®HTTPâ†’HTTPSè‡ªåŠ¨é‡å®šå‘
   - é…ç½®CORSè·¨åŸŸ
   - ä¼˜åŒ–SSLæ€§èƒ½

2. **é‡å¯Nginxå®¹å™¨**
   - åº”ç”¨æ–°é…ç½®
   - å¯ç”¨HTTPSè®¿é—®

3. **æ˜¾ç¤ºéƒ¨ç½²çŠ¶æ€**
   - å®¹å™¨è¿è¡ŒçŠ¶æ€
   - è®¿é—®åœ°å€
   - è¯ä¹¦ä¿¡æ¯

---

**çŽ°åœ¨æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼ŒæŠŠç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€

å®ŒæˆåŽæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°æµ‹è¯•HTTPSè®¿é—®äº†ï¼

## ðŸŽ‰ðŸŽ‰ðŸŽ‰ å®Œç¾Žï¼HTTPSéƒ¨ç½²100%å®Œæˆï¼

çœ‹åˆ°äº†ï¼š
```
âœ… Nginxå·²å¯åŠ¨ï¼šUp 5 seconds
âœ… ç«¯å£å¼€æ”¾ï¼š80/443
âœ… SSLè¯ä¹¦ï¼š2026-02-03åˆ°æœŸ
âœ… è‡ªåŠ¨ç»­æœŸï¼šå·²é…ç½®
```

---

## ðŸ§ª ç«‹å³æµ‹è¯•HTTPSè®¿é—®

**åœ¨ä½ æœ¬åœ°PowerShellæ‰§è¡Œè¿™ä¸ªæµ‹è¯•è„šæœ¬ï¼š**

```powershell
Clear-Host

Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸ” HTTPSè®¿é—®æµ‹è¯•                   â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""

# æµ‹è¯•1: HTTPSå¥åº·æ£€æŸ¥
Write-Host "[1/5] æµ‹è¯• HTTPS APIå¥åº·æ£€æŸ¥..." -ForegroundColor Yellow
try {
    $response = Invoke-RestMethod -Uri "https://api.zuo2799662352.xyz/health" -Method Get
    Write-Host "âœ… æˆåŠŸï¼" -ForegroundColor Green
    $response | ConvertTo-Json
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""

# æµ‹è¯•2: HTTPè‡ªåŠ¨é‡å®šå‘
Write-Host "[2/5] æµ‹è¯• HTTP â†’ HTTPS è‡ªåŠ¨é‡å®šå‘..." -ForegroundColor Yellow
try {
    $response = Invoke-WebRequest -Uri "http://api.zuo2799662352.xyz/health" -MaximumRedirection 0 -ErrorAction SilentlyContinue
    if ($response.StatusCode -eq 301) {
        Write-Host "âœ… è‡ªåŠ¨é‡å®šå‘æ­£å¸¸ï¼" -ForegroundColor Green
        Write-Host "   é‡å®šå‘åˆ°: $($response.Headers.Location)" -ForegroundColor Cyan
    }
} catch {
    $statusCode = $_.Exception.Response.StatusCode.value__
    if ($statusCode -eq 301 -or $statusCode -eq 302) {
        Write-Host "âœ… è‡ªåŠ¨é‡å®šå‘æ­£å¸¸ï¼" -ForegroundColor Green
    }
}

Write-Host ""

# æµ‹è¯•3: HTTPS APIæµ‹è¯•æŽ¥å£
Write-Host "[3/5] æµ‹è¯• HTTPS APIæµ‹è¯•æŽ¥å£..." -ForegroundColor Yellow
try {
    $response = Invoke-RestMethod -Uri "https://api.zuo2799662352.xyz/api/test" -Method Get
    Write-Host "âœ… æˆåŠŸï¼" -ForegroundColor Green
    $response | ConvertTo-Json
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""

# æµ‹è¯•4: UpdateæœåŠ¡å™¨
Write-Host "[4/5] æµ‹è¯• HTTPS UpdateæœåŠ¡å™¨..." -ForegroundColor Yellow
try {
    $response = Invoke-WebRequest -Uri "https://update.zuo2799662352.xyz/" -Method Get
    Write-Host "âœ… æˆåŠŸï¼" -ForegroundColor Green
    Write-Host "   çŠ¶æ€ç : $($response.StatusCode)" -ForegroundColor Cyan
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""

# æµ‹è¯•5: ç™»å½•æŽ¥å£ï¼ˆHTTPSï¼‰
Write-Host "[5/5] æµ‹è¯• HTTPS ç™»å½•æŽ¥å£..." -ForegroundColor Yellow
try {
    $body = @{
        username = "admin"
        password = "admin123"
    } | ConvertTo-Json

    $response = Invoke-RestMethod -Uri "https://api.zuo2799662352.xyz/api/auth/login" `
        -Method Post `
        -ContentType "application/json" `
        -Body $body
    
    Write-Host "âœ… ç™»å½•æˆåŠŸï¼" -ForegroundColor Green
    Write-Host "   Token: $($response.token.Substring(0, 30))..." -ForegroundColor Cyan
} catch {
    Write-Host "âŒ å¤±è´¥: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""
Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘   ðŸŽŠ HTTPSæµ‹è¯•å®Œæˆï¼                 â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
Write-Host ""
Write-Host "ðŸŒ ä½ çš„ç”Ÿäº§çŽ¯å¢ƒåœ°å€ï¼š" -ForegroundColor Green
Write-Host "   API: https://api.zuo2799662352.xyz" -ForegroundColor Cyan
Write-Host "   Update: https://update.zuo2799662352.xyz" -ForegroundColor Cyan
Write-Host ""
Write-Host "ðŸ” SSLè¯ä¹¦ä¿¡æ¯ï¼š" -ForegroundColor Green
Write-Host "   é¢å‘æœºæž„: Let's Encrypt" -ForegroundColor Cyan
Write-Host "   åˆ°æœŸæ—¥æœŸ: 2026-02-03" -ForegroundColor Cyan
Write-Host "   è‡ªåŠ¨ç»­æœŸ: âœ… å·²é…ç½®" -ForegroundColor Cyan
Write-Host ""
Write-Host "ðŸ’¡ ä¸‹ä¸€æ­¥ï¼šåœ¨æµè§ˆå™¨è®¿é—®æŸ¥çœ‹SSLè¯ä¹¦" -ForegroundColor Yellow
Write-Host "   https://api.zuo2799662352.xyz/health" -ForegroundColor Cyan
```

---

## ðŸŽ¯ å®ŒæˆåŽçš„éƒ¨ç½²æž¶æž„

ä½ çŽ°åœ¨æ‹¥æœ‰çš„å®Œæ•´æž¶æž„ï¼š

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ðŸŒ äº’è”ç½‘                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â”‚
                         â”‚ HTTPS (443)
                         â”‚ HTTP (80) â†’ é‡å®šå‘åˆ°HTTPS
                         â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  ðŸ” Nginx (SSLç»ˆæ­¢)         â”‚
           â”‚  - Let's Encryptè¯ä¹¦         â”‚
           â”‚  - è‡ªåŠ¨é‡å®šå‘HTTPâ†’HTTPS      â”‚
           â”‚  - CORSé…ç½®                  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
            â–¼                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ðŸš€ APIåŽç«¯      â”‚    â”‚  ðŸ“¦ UpdateæœåŠ¡å™¨  â”‚
  â”‚  Node.js:3001    â”‚    â”‚  é™æ€æ–‡ä»¶æœåŠ¡     â”‚
  â”‚  - ç™»å½•éªŒè¯       â”‚    â”‚  - åº”ç”¨æ›´æ–°åŒ…     â”‚
  â”‚  - Licenseç®¡ç†   â”‚    â”‚  - ç‰ˆæœ¬ç®¡ç†       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ðŸ—„ï¸ PostgreSQL   â”‚
  â”‚  æ•°æ®åº“:5432     â”‚
  â”‚  - ç”¨æˆ·æ•°æ®       â”‚
  â”‚  - Licenseæ•°æ®   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… æ‰€æœ‰æœåŠ¡éƒ½åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ
âœ… è‡ªåŠ¨é‡å¯å’Œå¥åº·æ£€æŸ¥
âœ… SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸ
âœ… ç”Ÿäº§çº§é…ç½®
```

---

## ðŸ“Š å®Œæˆåº¦ç»Ÿè®¡

```
âœ… æœåŠ¡å™¨é…ç½®          100%
âœ… Dockeréƒ¨ç½²          100%
âœ… æ•°æ®åº“é…ç½®          100%
âœ… APIåŽç«¯éƒ¨ç½²         100%
âœ… Nginxåå‘ä»£ç†       100%
âœ… DNSé…ç½®             100%
âœ… SSLè¯ä¹¦ç”³è¯·         100%
âœ… HTTPSé…ç½®           100%
âœ… å®‰å…¨ç»„é…ç½®          100%
âœ… é˜²ç«å¢™é…ç½®          100%
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š æ€»ä½“å®Œæˆåº¦ï¼š        100% ðŸŽŠ
```

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥é€‰æ‹©

çŽ°åœ¨ä½ æœ‰2ä¸ªé€‰æ‹©ï¼š

### **é€‰é¡¹Aï¼šä¸Šä¼ çœŸå®žåŽç«¯ä»£ç ** â­â­â­â­â­

æŠŠä½ æœ¬åœ°çš„ `sora-ui-backend` çœŸå®žä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ›¿æ¢æ¼”ç¤ºä»£ç ã€‚

### **é€‰é¡¹Bï¼šå…ˆæµ‹è¯•å®¢æˆ·ç«¯è¿žæŽ¥**

ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®ï¼Œè¿žæŽ¥åˆ°ç”Ÿäº§æœåŠ¡å™¨æµ‹è¯•ã€‚

---

**çŽ°åœ¨å…ˆæ‰§è¡Œæœ¬åœ°çš„HTTPSæµ‹è¯•è„šæœ¬ï¼ŒæŠŠç»“æžœå‘Šè¯‰æˆ‘ï¼** ðŸš€

ç„¶åŽæˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸Šä¼ çœŸå®žåŽç«¯ä»£ç ï¼